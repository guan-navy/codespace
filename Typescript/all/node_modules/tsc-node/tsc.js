"use strict";
const TS = require("typescript");
const fs = require("fs");
const path_1 = require("path");
const cwd = process.cwd();
const { config } = TS.readConfigFile(path_1.join(cwd, 'tsconfig.json'), (path) => fs.readFileSync(path).toString());
let { outdir = '.dist' } = config.compilerOptions;
outdir = path_1.join(cwd, outdir);
/**typescript transplier server */
// const Server = 
// TS.createLanguageService({})
const originalHandler = require.extensions['.js'];
function registerExtension(ext) {
    const old = require.extensions[ext] || originalHandler;
    require.extensions[ext] =
        function (m, filename) {
            const _compile = m._compile;
            m._compile = function (code, fileName) {
                code = TS.transpile(code, config.compilerOptions);
                return _compile.call(this, code, fileName);
            };
            return old(m, filename);
        };
}
registerExtension('.ts');
registerExtension('.tsx');
//# sourceMappingURL=tsc.js.map