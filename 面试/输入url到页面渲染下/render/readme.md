# 网页性能优化笔记

## 浏览器资源处理流程

1. 浏览器获取资源后，解析HTML代码生成DOM树。
2. 解析CSS，生成CSSOM树（注意CSS优化，避免过度嵌套）。
3. 合并DOM树和CSSOM树，生成Render Tree，去除不可见元素。
4. 计算布局（回流|重排），根据Render Tree计算每节点的几何信息。
5. 绘制页面（重绘），GPU根据布局信息进行绘制。

## 什么是回流

- 浏览器计算页面布局的过程称为回流，常见变更触发回流：
  1. 改变窗口尺寸
  2. 改变元素大小
  3. 增加或删除可见元素
  4. 页面初次渲染

## 什么是重绘

- 重绘是将已计算好布局的容器在屏幕上展示出来，非几何属性变化时触发，如：
  1. 修改背景颜色
  2. 修改背景图片
  3. 边框颜色
  4. 字体颜色

- 重绘不一定导致回流，但发生回流一定会触发重绘。

## 浏览器优化策略

- 当元素样式变更导致回流时，浏览器采用渲染队列机制，将操作进入队列，批量执行一次回流。

- 属性/方法如`offsetWidth`, `scrollHeight`等会强制执行渲染队列，需谨慎使用。

## 减少回流重绘的方法

1. **合理利用浏览器优化策略。**
2. **先设置样式`display:none`，再修改样式，最后恢复`display:block`，以防止渲染队列过载。**


获取window的宽度innerwidth
